# Fantasy Hockey Bot

Бот для сбора и анализа статистики игроков НХЛ, формирования команд дня/периода и отправки результатов в Telegram.

## Основные возможности

- Сбор ежедневной статистики игроков НХЛ через ESPN API
- Формирование команды дня из лучших игроков по позициям
- Формирование команды за произвольный период
- Создание визуальных коллажей с фотографиями игроков
- Отправка результатов в Telegram канал
- История выбранных игроков для предотвращения повторов
- Система оценки игроков на основе различных статистических показателей

## Установка

1. Клонируйте репозиторий:
```bash
git clone git@github.com:amatjkay/fantasy-hockey-bot.git
cd fantasy-hockey-bot
```

2. Создайте виртуальное окружение и установите зависимости:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
pip install -r requirements.txt
```

3. Создайте файл конфигурации `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

4. Заполните необходимые переменные окружения в `.env`:
- `TELEGRAM_BOT_TOKEN` - токен вашего Telegram бота
- `TELEGRAM_CHANNEL_ID` - ID канала для отправки сообщений

## Использование

### Сбор ежедневной статистики

```bash
# Обработка статистики за вчерашний день
python scripts/app_day.py

# Обработка статистики за конкретную дату
python scripts/app_day.py --date YYYY-MM-DD

# Обработка без отправки в Telegram
python scripts/app_day.py --no-send
```

### Обработка статистики за период

```bash
# Обработка статистики за конкретный период
python scripts/rewrite_all_stats.py --week YYYY-MM-DD:YYYY-MM-DD

# Обработка статистики за конкретную дату
python scripts/rewrite_all_stats.py --date YYYY-MM-DD

# Обработка всех периодов с начала сезона
python scripts/rewrite_all_stats.py --all-weeks

# Обработка без отправки в Telegram
python scripts/rewrite_all_stats.py --week YYYY-MM-DD:YYYY-MM-DD --no-send
```

## Структура проекта

```
fantasy-hockey-bot/
├── data/                    # Данные и ресурсы
│   ├── collages/           # Сгенерированные коллажи
│   ├── history/            # История выбранных игроков
│   └── photos/             # Фотографии игроков
├── scripts/                # Скрипты для запуска
│   ├── app_day.py         # Обработка ежедневной статистики
│   └── rewrite_all_stats.py # Обработка статистики за период
├── services/              # Основные сервисы
│   ├── espn_service.py   # Работа с ESPN API
│   ├── image_service.py  # Создание коллажей
│   └── telegram_service.py # Отправка в Telegram
└── utils/                 # Вспомогательные функции
```

## Технические детали

- Python 3.8+
- Асинхронное выполнение запросов
- Кэширование фотографий игроков
- Система предотвращения повторов игроков
- Гибкая система оценки игроков
- Поддержка различных форматов вывода

## Рекомендации по развитию

- Добавление новых источников данных
- Расширение системы оценки игроков
- Улучшение визуального представления
- Добавление интерактивных функций в Telegram
- Реализация веб-интерфейса для управления
